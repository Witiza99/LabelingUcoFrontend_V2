{"ast":null,"code":"/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { deferInit, getBase64Image } from './utils.js';\n\n// https://exiftool.org/TagNames/EXIF.html#Compression\nconst COMPRESSION_JPEG = [6, 7, 99];\nexport default {\n  get\n};\nfunction get(dataView, thumbnailTags, tiffHeaderOffset) {\n  if (hasJpegThumbnail(thumbnailTags)) {\n    thumbnailTags.type = 'image/jpeg';\n    const offset = tiffHeaderOffset + thumbnailTags.JPEGInterchangeFormat.value;\n    thumbnailTags.image = dataView.buffer.slice(offset, offset + thumbnailTags.JPEGInterchangeFormatLength.value);\n    deferInit(thumbnailTags, 'base64', function () {\n      return getBase64Image(this.image);\n    });\n  }\n\n  // There is a small possibility of thumbnails in TIFF format but they are\n  // not stored as a self-contained image file and would be much more\n  // difficult to extract.\n  // https://exiftool.org/forum/index.php?topic=3273.msg14778#msg14778\n\n  return thumbnailTags;\n}\nfunction hasJpegThumbnail(tags) {\n  return tags && (tags.Compression === undefined || COMPRESSION_JPEG.includes(tags.Compression.value)) && tags.JPEGInterchangeFormat && tags.JPEGInterchangeFormat.value && tags.JPEGInterchangeFormatLength && tags.JPEGInterchangeFormatLength.value;\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}